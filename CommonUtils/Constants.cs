using System.Collections.Generic;

namespace CommonUtils
{
    public static class Constants
    {
        public static HashSet<string> DeprecatedWords = new HashSet<string>()
        {
            "accept",
            "all",
            "All",
            "and",
            "any",
            "Any",
            "apr",
            "Apr",
            "april",
            "April",
            "aug",
            "Aug",
            "august",
            "August",
            "black",
            "blackboxs",
            "blue",
            "broadcasts",
            "call",
            "comment",
            "conn",
            "date",
            "day",
            "debug",
            "dec",
            "Dec",
            "december",
            "December",
            "deffunc",
            "define",
            "delete",
            "delstate",
            "direction",
            "do",
            "domains",
            "drop",
            "dst",
            "dynamic",
            "edge",
            "else",
            "expcall",
            "expires",
            "export",
            "fcall",
            "feb",
            "Feb",
            "february",
            "February",
            "firebrick",
            "foreground",
            "forest",
            "format",
            "fri",
            "Fri",
            "friday",
            "Friday",
            "from",
            "fw1",
            "FW1",
            "fwline",
            "fwrule",
            "gateways",
            "get",
            "getstate",
            "gold",
            "gray",
            "green",
            "hashsize",
            "hold",
            "host",
            "hosts",
            "if",
            "ifaddr",
            "ifid",
            "implies",
            "in",
            "inbound",
            "instate",
            "interface",
            "interfaces",
            "ipsecdata",
            "ipsecmethods",
            "is ",
            "jan",
            "Jan",
            "january",
            "January",
            "jul",
            "Jul",
            "july",
            "July",
            "jun",
            "Jun",
            "june",
            "June",
            "kbuf",
            "keep",
            "limit",
            "local",
            "localhost",
            "log",
            "LOG",
            "logics",
            "magenta",
            "mar",
            "Mar",
            "march",
            "March",
            "may",
            "May",
            "mday",
            "medium",
            "modify",
            "mon",
            "Mon",
            "monday",
            "Monday",
            "month",
            "mortrap",
            "navy",
            "netof",
            "nets",
            "nexpires",
            "not",
            "nov",
            "Nov",
            "november",
            "November",
            "oct",
            "Oct",
            "october",
            "October",
            "or",
            "orange",
            "origdport",
            "origdst",
            "origsport",
            "origsrc",
            "other",
            "outbound",
            "packet",
            "packetid",
            "packetlen",
            "pass",
            "r_arg",
            "r_call_counter",
            "r_cdir",
            "r_cflags",
            "r_chandler",
            "r_client_community",
            "r_client_ifs_grp",
            "r_community_left",
            "r_connarg",
            "r_spii_uuid4",
            "r_str_dport",
            "r_str_dst",
            "r_str_ipp",
            "r_str_sport",
            "r_str_src",
            "r_user",
            "record",
            "red",
            "refresh",
            "reject",
            "routers",
            "r_crule",
            "r_ctimeout",
            "r_ctype",
            "r_curr_feature_id",
            "r_data_offset",
            "r_dtmatch",
            "r_dtmflags",
            "r_entry",
            "r_g_offset",
            "r_ipv6",
            "r_mapped_ip",
            "r_mflags",
            "r_mhandler",
            "r_mtimeout",
            "r_oldcdir",
            "r_pflags",
            "r_profile_id",
            "r_ro_client_community",
            "r_ro_dst_sr",
            "r_ro_server_community",
            "r_ro_src_sr",
            "r_scvres",
            "r_server_community",
            "r_server_ifs_grp",
            "r_service_id",
            "r_simple_hdrlen",
            "r_spii_ret",
            "r_spii_tcpseq",
            "r_spii_uuid1",
            "r_spii_uuid2",
            "r_spii_uuid3",
            "sat",
            "Sat",
            "saturday",
            "Saturday",
            "second",
            "sep",
            "Sep",
            "september",
            "September",
            "set",
            "setstate",
            "skipme",
            "skippeer",
            "sr",
            "src",
            "static",
            "sun",
            "Sun",
            "sunday",
            "Sunday",
            "switchs",
            "sync",
            "targets",
            "thu",
            "Thu",
            "thursday",
            "Thursday",
            "to",
            "tod",
            "tue",
            "Tue",
            "tuesday",
            "Tuesday",
            "ufp",
            "vanish",
            "vars",
            "wasskipped",
            "wed",
            "Wed",
            "wednesday",
            "Wednesday",
            "while",
            "xlatedport",
            "xlatedst",
            "xlatemethod",
            "xlatesport",
            "xlatesrc",
            "xor",
            "year",
            "zero",
            "zero_ip"
        };
    }

    public static class Validators
    {
        /// <summary>
        /// Removes from name deprecated parts
        /// </summary>
        /// <param name="oldName">old name</param>
        /// <returns>new valid name</returns>
        public static string ChangeNameAccordingToRules(string oldName)
        {
            string[] oldNameParts = oldName.Split('-');
            List<string> newNameParts = new List<string>();

            foreach (string part in oldNameParts)
            {
                if (Constants.DeprecatedWords.Contains(part))
                    continue;
                else
                    newNameParts.Add(part);
            }

            return string.Join("-", newNameParts.ToArray());
        }
    }
}
